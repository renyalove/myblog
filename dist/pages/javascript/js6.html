<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>红宝书第六章——面向对象的程序设计 | practice makes perfect</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/myblog/logo.png">
    <meta name="description" content="练习文档">
    <link rel="preload" href="/myblog/assets/css/0.styles.12a616e5.css" as="style"><link rel="preload" href="/myblog/assets/js/app.48f40e30.js" as="script"><link rel="preload" href="/myblog/assets/js/2.667dd462.js" as="script"><link rel="preload" href="/myblog/assets/js/14.b8794301.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.45d5a2be.js"><link rel="prefetch" href="/myblog/assets/js/11.add8b250.js"><link rel="prefetch" href="/myblog/assets/js/12.d5451c88.js"><link rel="prefetch" href="/myblog/assets/js/13.2b84f2a6.js"><link rel="prefetch" href="/myblog/assets/js/15.4b31a7dc.js"><link rel="prefetch" href="/myblog/assets/js/3.c15b449a.js"><link rel="prefetch" href="/myblog/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/myblog/assets/js/5.f8be39f3.js"><link rel="prefetch" href="/myblog/assets/js/6.09e57873.js"><link rel="prefetch" href="/myblog/assets/js/7.70f31a64.js"><link rel="prefetch" href="/myblog/assets/js/8.9a172e0f.js"><link rel="prefetch" href="/myblog/assets/js/9.e1099846.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.12a616e5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><img src="/myblog/logo.png" alt="practice makes perfect" class="logo"> <span class="site-name can-hide">practice makes perfect</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/pages/javascript/" class="nav-link router-link-active">
  JavaScript
</a></div><div class="nav-item"><a href="/myblog/pages/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/folder1/test1.html" class="nav-link">
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/myblog/language/japanese.html" class="nav-link">
  Japanese
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级" class="dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/myblog/language/chinese.html" class="nav-link">
  冒泡
</a></li><li class="dropdown-subitem"><a href="/myblog/language/japanese.html" class="nav-link">
  快速
</a></li></ul></li><li class="dropdown-item"><h4>
          设计模式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/myblog/language/chinese.html" class="nav-link">
  工厂
</a></li><li class="dropdown-subitem"><a href="/myblog/language/chinese.html" class="nav-link">
  单例
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/myblog/pages/javascript/" class="nav-link router-link-active">
  JavaScript
</a></div><div class="nav-item"><a href="/myblog/pages/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/folder1/test1.html" class="nav-link">
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/myblog/language/japanese.html" class="nav-link">
  Japanese
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级" class="dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          算法
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/myblog/language/chinese.html" class="nav-link">
  冒泡
</a></li><li class="dropdown-subitem"><a href="/myblog/language/japanese.html" class="nav-link">
  快速
</a></li></ul></li><li class="dropdown-item"><h4>
          设计模式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/myblog/language/chinese.html" class="nav-link">
  工厂
</a></li><li class="dropdown-subitem"><a href="/myblog/language/chinese.html" class="nav-link">
  单例
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>红宝书第六章——面向对象的程序设计</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/javascript/js6.html#一、理解对象" class="sidebar-link">一、理解对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_1-1-数据属性" class="sidebar-link">1.1 数据属性</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_1-2-访问器属性" class="sidebar-link">1.2 访问器属性</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_1-3-定义多个属性" class="sidebar-link">1.3. 定义多个属性</a></li></ul></li><li><a href="/myblog/pages/javascript/js6.html#二、创建对象" class="sidebar-link">二、创建对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_1-工厂模式" class="sidebar-link">(1)工厂模式</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_2-构造函数模式" class="sidebar-link">(2)构造函数模式</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_3-原型模式" class="sidebar-link">(3)原型模式</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_4-组合模式" class="sidebar-link">(4)组合模式</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_5-动态原型模式" class="sidebar-link">(5)动态原型模式</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_6-寄生构造函数模式" class="sidebar-link">(6)寄生构造函数模式</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_7-稳妥构造函数模式" class="sidebar-link">(7)稳妥构造函数模式</a></li></ul></li><li><a href="/myblog/pages/javascript/js6.html#三、继承" class="sidebar-link">三、继承</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_3-1-理解原型" class="sidebar-link">3.1 理解原型</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_3-2-确定原型和实例的关系" class="sidebar-link">3.2 确定原型和实例的关系</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#_3-3-继承方法" class="sidebar-link">3.3 继承方法</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#（1）原型链继承" class="sidebar-link">（1）原型链继承</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#（2）借用构造函数" class="sidebar-link">（2）借用构造函数</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#（3）组合继承" class="sidebar-link">（3）组合继承</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#（4）原型式继承" class="sidebar-link">（4）原型式继承</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#（5）-寄生式继承" class="sidebar-link">（5） 寄生式继承</a></li><li class="sidebar-sub-header"><a href="/myblog/pages/javascript/js6.html#（6）寄生组合式继承" class="sidebar-link">（6）寄生组合式继承</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="红宝书第六章-面向对象的程序设计"><a href="#红宝书第六章-面向对象的程序设计" class="header-anchor">#</a> 红宝书第六章——面向对象的程序设计</h1> <p></p><div class="table-of-contents"><ul><li><a href="#一、理解对象">一、理解对象</a><ul><li><a href="#_1-1-数据属性">1.1 数据属性</a></li><li><a href="#_1-2-访问器属性">1.2 访问器属性</a></li><li><a href="#_1-3-定义多个属性">1.3. 定义多个属性</a></li></ul></li><li><a href="#二、创建对象">二、创建对象</a><ul><li><a href="#_1-工厂模式">(1)工厂模式</a></li><li><a href="#_2-构造函数模式">(2)构造函数模式</a></li><li><a href="#_3-原型模式">(3)原型模式</a></li><li><a href="#_4-组合模式">(4)组合模式</a></li><li><a href="#_5-动态原型模式">(5)动态原型模式</a></li><li><a href="#_6-寄生构造函数模式">(6)寄生构造函数模式</a></li><li><a href="#_7-稳妥构造函数模式">(7)稳妥构造函数模式</a></li></ul></li><li><a href="#三、继承">三、继承</a><ul><li><a href="#_3-1-理解原型">3.1 理解原型</a></li><li><a href="#_3-2-确定原型和实例的关系">3.2 确定原型和实例的关系</a></li><li><a href="#_3-3-继承方法">3.3 继承方法</a></li><li><a href="#（1）原型链继承">（1）原型链继承</a></li><li><a href="#（2）借用构造函数">（2）借用构造函数</a></li><li><a href="#（3）组合继承">（3）组合继承</a></li><li><a href="#（4）原型式继承">（4）原型式继承</a></li><li><a href="#（5）-寄生式继承">（5） 寄生式继承</a></li><li><a href="#（6）寄生组合式继承">（6）寄生组合式继承</a></li></ul></li></ul></div><p></p> <h2 id="一、理解对象"><a href="#一、理解对象" class="header-anchor">#</a> 一、理解对象</h2> <p>新建对象：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;sera&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;tom&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayHi</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ECMAScript<code>中有两类属性，分别是</code>数据属性<code>与</code>选择器属性</p> <h3 id="_1-1-数据属性"><a href="#_1-1-数据属性" class="header-anchor">#</a> 1.1 数据属性</h3> <p>数据属性包含一个数据值的位置。在这个位置可以读取和写入值。数据属性有 4 个描述其行为的 特性。</p> <ul><li><code>[[Configurable]]</code>:表示能否通过<code>delete</code>删除属性从而重新定义属性，能否修改属性的特性，或者能否把属性修改为访问器属性。</li> <li><code>[[Enumerable]]</code>:表示能否通过for-in循环返回属性。</li> <li><code>[[Writable]]</code>:表示能否修改属性的值。</li> <li><code>[[Value]]</code>:包含这个属性的数据值。</li></ul> <p>通过<code>new object</code>或者对象字面量方式创建对象定义的属性，他们的<code>[[Configurable]]</code>、<code>[[Enumerable]]</code>、<code>[[Writable]]</code>特征均为<code>true</code>，而<code>[[Value]]</code>值被设置为指定的值。</p> <p>要修改属性默认的特性，必须使用Object.defineProperty()方法 .</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  configurable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  value<span class="token operator">:</span> <span class="token string">'Bob'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'helen'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Bob</span>
<span class="token keyword">delete</span> person<span class="token punctuation">.</span>name
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Bob</span>
</code></pre></div><h3 id="_1-2-访问器属性"><a href="#_1-2-访问器属性" class="header-anchor">#</a> 1.2 访问器属性</h3> <p>访问器属性不包含数据值；它们包含一对儿<code>getter</code>和<code>setter</code> 函数（不过，这两个函数都不是必需的）。在读取访问器属性时，会调用<code>getter</code> 函数，这个函数负责返回有效的值；在写入访问器属性时，会调用 <code>setter</code>函数并传入新值，这个函数负责决定如何处理数据。访问器属性有如下 4 个特性。</p> <ul><li><code>[[Configurable]]</code>：特性同1.1数据属性的该特征值</li> <li><code>[[Enumerable]]</code>：特性同1.1数据属性的该特征值</li> <li><code>[[Get]]</code>：在读取属性时调用的函数。默认值为 undefined。</li> <li><code>[[Set]]</code>：在写入属性时调用的函数。默认值为 undefined。</li></ul> <p>访问器属性不能直接定义，必须使用 <code>Object.defineProperty()</code>来定义</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// !设置一个属性会使另外的属性发生变化</span>
<span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>
_year<span class="token operator">:</span> <span class="token number">2020</span><span class="token punctuation">,</span>
edition<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>

 <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_year
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>newValue <span class="token operator">&gt;</span> <span class="token number">2020</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>_year <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>edition <span class="token operator">+=</span> newValue <span class="token operator">-</span> <span class="token number">2020</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
book<span class="token punctuation">.</span>year<span class="token operator">=</span><span class="token number">2021</span>
book<span class="token punctuation">.</span>edition<span class="token comment">//2</span>
</code></pre></div><h3 id="_1-3-定义多个属性"><a href="#_1-3-定义多个属性" class="header-anchor">#</a> 1.3. 定义多个属性</h3> <p>利用<code>Object.defineProperty()</code>定义单个属性。利用<code>Object.defineProperties()</code>同时定义多个属性，该方法接收两个参数，具体使用方式见如下代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  year<span class="token operator">:</span><span class="token punctuation">{</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    configurable<span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  edition<span class="token operator">:</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span><span class="token number">2025</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>总结：</strong></p> <p>（1）所有直接通过<code>new object</code>或者对象字面量为对象添加的属性均为数据属性，访问器属性必须用<code>Object.defineProperty()</code>定义。</p> <p>（2）通过<code>new object</code>或者对象字面量为对象添加的属性，其<code>[[Configurable]]</code>、<code>[[Enumerable]]</code>、<code>[[Writable]]</code>属性默认均为<code>true</code>，通过<code>Object.defineProperty()</code>定义的属性，对于<code>defineProperty</code>方法没定义的特征，默认为<code>false</code>。</p> <h2 id="二、创建对象"><a href="#二、创建对象" class="header-anchor">#</a> 二、创建对象</h2> <h3 id="_1-工厂模式"><a href="#_1-工厂模式" class="header-anchor">#</a> (1)工厂模式</h3> <p>直接调用函数创建实例，无法解决对象识别问题。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  o<span class="token punctuation">.</span>name <span class="token operator">=</span> name
  o<span class="token punctuation">.</span>age <span class="token operator">=</span> age
  o<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p1<span class="token operator">=</span><span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">'tom'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-构造函数模式"><a href="#_2-构造函数模式" class="header-anchor">#</a> (2)构造函数模式</h3> <p>解决对象不可识别问题，但是每个方法都要新创建一遍，每个实例的同名函数不相等。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">CreatePerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> zs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreatePerson</span><span class="token punctuation">(</span><span class="token string">'zs'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>zs<span class="token punctuation">.</span>constructor<span class="token operator">==</span>CreatePerson<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-原型模式"><a href="#_3-原型模式" class="header-anchor">#</a> (3)原型模式</h3> <p>每个对象都一样，不能传值，原型上定义了引用类型，每个实例都会引用同一份，没啥意义。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'sera'</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">23</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>

<span class="token comment">// 可以合并写</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 重写原型要更改其构造函数指向</span>
  constructor<span class="token operator">:</span> Person<span class="token punctuation">,</span>
  name<span class="token operator">:</span><span class="token string">'sera'</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayHi</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 此时要修改constructor的属性</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">'constructor'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span><span class="token string">'Person'</span><span class="token punctuation">,</span>
  enumerable<span class="token operator">:</span><span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-组合模式"><a href="#_4-组合模式" class="header-anchor">#</a> (4)组合模式</h3> <p>构造函数定义实例属性，原型定义共享方法和属性,应用最广泛。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>hobbies<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'eat'</span><span class="token punctuation">,</span><span class="token string">'drink'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  constructor<span class="token operator">:</span> Person<span class="token punctuation">,</span>
  <span class="token function-variable function">sayHi</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'  hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'ry'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_5-动态原型模式"><a href="#_5-动态原型模式" class="header-anchor">#</a> (5)动态原型模式</h3> <p>解决组合模式的封装性问题。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sayHi <span class="token operator">!=</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>      
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'alice'</span><span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">)</span>
p3<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//可立即放映原型的更新</span>
</code></pre></div><h3 id="_6-寄生构造函数模式"><a href="#_6-寄生构造函数模式" class="header-anchor">#</a> (6)寄生构造函数模式</h3> <p>除了使用new 之外和工厂模式没啥区别，可在特殊情况为对象创建构造函数，比如有特殊方法的数组，不直接修改Array构造函数时可用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  o<span class="token punctuation">.</span>name <span class="token operator">=</span> name
  o<span class="token punctuation">.</span>age <span class="token operator">=</span> age
  o<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'sera'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_7-稳妥构造函数模式"><a href="#_7-稳妥构造函数模式" class="header-anchor">#</a> (7)稳妥构造函数模式</h3> <p>没有公共属性，实例方法不引用this,实例化对象不使用new。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span>job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  o<span class="token punctuation">.</span>name <span class="token operator">=</span> name
  o<span class="token punctuation">.</span>age <span class="token operator">=</span> age
  o<span class="token punctuation">.</span>job<span class="token operator">=</span>job
  o<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ?这里不使用this.name ，从而创建了一个私有属性，name只能通过该函数访问到</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">'sera'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'dreamer'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//sera</span>
</code></pre></div><h2 id="三、继承"><a href="#三、继承" class="header-anchor">#</a> 三、继承</h2> <h3 id="_3-1-理解原型"><a href="#_3-1-理解原型" class="header-anchor">#</a> 3.1 理解原型</h3> <p>简单回顾下构造函数,原型和实例的关系:</p> <blockquote><p>每个构造函数(constructor)都有一个原型对象(prototype),原型对象都包含一个指向构造函数的指针,而实例(instance)都包含一个指向原型对象的内部指针.</p></blockquote> <p>JS对象的圈子里有这么个游戏规则:</p> <blockquote><p>如果试图引用对象(实例instance)的某个属性,会首先在对象内部寻找该属性,直至找不到,然后才在该对象的原型(instance.prototype)里去找这个属性.</p></blockquote> <p>如果让原型对象指向另一个类型的实例.....有趣的事情便发生了.</p> <p>即: constructor1.prototype = instance2</p> <p>鉴于上述游戏规则生效,如果试图引用constructor1构造的实例instance1的某个属性p1:</p> <p>1).首先会在instance1内部属性中找一遍;</p> <p>2).接着会在instance1.<strong>proto</strong>(constructor1.prototype)中找一遍,而constructor1.prototype 实际上是instance2, 也就是说在instance2中寻找该属性p1;</p> <p>3).如果instance2中还是没有,此时程序不会灰心,它会继续在instance2.<strong>proto</strong>(constructor2.prototype)中寻找...直至Object的原型对象</p> <blockquote><p>搜索轨迹: instance1--&gt; instance2 --&gt; constructor2.prototype…--&gt;Object.prototype</p></blockquote> <p>这种搜索的轨迹,形似一条长链, 又因prototype在这个游戏规则中充当链接的作用,于是我们把这种实例与原型的链条称作 <strong>原型链</strong> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>property <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSuperValue</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>property
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>getSubValue <span class="token operator">-=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>property<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">getSuperValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>p实例通过原型链找到了Super中的属性和方法。</p> <h3 id="_3-2-确定原型和实例的关系"><a href="#_3-2-确定原型和实例的关系" class="header-anchor">#</a> 3.2 确定原型和实例的关系</h3> <p>使用原型链后, 我们怎么去判断原型和实例的这种继承关系呢? 方法一般有两种.</p> <blockquote><p>第一种是使用 <strong>instanceof</strong> 操作符, 只要用这个操作符来测试实例(instance)与原型链中出现过的构造函数,结果就会返回true. 以下几行代码就说明了这点.</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">alert</span><span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token function">alert</span><span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">Super</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token function">alert</span><span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">Sub</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
</code></pre></div><p>由于原型链的关系, 我们可以说instance 是 Object, Father 或 Son中任何一个类型的实例. 因此, 这三个构造函数的结果都返回了true.</p> <blockquote><p>第二种是使用 <strong>isPrototypeOf()</strong> 方法, 同样只要是原型链中出现过的原型,isPrototypeOf() 方法就会返回true, 如下所示.</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">alert</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
</code></pre></div><p>还有一种方法是对象的Object.getPrototypeOf（）方法。</p> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">==</span><span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token comment">//true</span>
</code></pre></div><h3 id="_3-3-继承方法"><a href="#_3-3-继承方法" class="header-anchor">#</a> 3.3 继承方法</h3> <h3 id="（1）原型链继承"><a href="#（1）原型链继承" class="header-anchor">#</a> （1）原型链继承</h3> <p>如上面代码所示，有如下问题：</p> <blockquote><p>问题一: 当原型链中包含引用类型值的原型时,该引用类型值会被所有实例共享;</p> <p>问题二: 在创建子类型(例如创建Son的实例)时,不能向超类型(例如Father)的构造函数中传递参数.</p></blockquote> <h3 id="（2）借用构造函数"><a href="#（2）借用构造函数" class="header-anchor">#</a> （2）借用构造函数</h3> <p>即在子类型构造函数的内部调用超类型构造函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Super</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token comment">//借用构造函数</span>
  <span class="token function">Super</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token string">'sera'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token string">'lili'</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'--'</span><span class="token operator">+</span>p1<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//sera--red,yellow</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'--'</span><span class="token operator">+</span>p2<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//lili--red</span>
p1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
p3<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//error 原型上的方法不可用</span>
</code></pre></div><p>解决了引用类型被实例共享问题，以及不能向超类传值问题。但是，方法都在构造函数中定义，函数不可复用。且超类原型上的方法对子类不可见。</p> <h3 id="（3）组合继承"><a href="#（3）组合继承" class="header-anchor">#</a> （3）组合继承</h3> <p>组合原型链继承和构造函数继承。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Super</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello,'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token comment">// 继承属性</span>
  <span class="token function">Super</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token comment">//第二次调用</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">=</span>age
<span class="token punctuation">}</span>

<span class="token comment">// 继承方法</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//第一次调用</span>
<span class="token comment">// 改了原型，要修改构造函数</span>

<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token operator">=</span>Sub
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token string">'sera'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1 <span class="token keyword">instanceof</span> <span class="token class-name">Sub</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1 <span class="token keyword">instanceof</span> <span class="token class-name">Super</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
</code></pre></div><p>组合继承避免了原型链和借用构造函数的缺陷,融合了它们的优点,成为 JavaScript 中最常用的继承模式. 而且, instanceof 和 isPrototypeOf( )也能用于识别基于组合继承创建的对象。但组合继承其实调用了两次父类构造函数, 造成了不必要的消耗。</p> <h3 id="（4）原型式继承"><a href="#（4）原型式继承" class="header-anchor">#</a> （4）原型式继承</h3> <p>在object()函数内部, 先创建一个临时性的构造函数, 然后将传入的对象作为这个构造函数的原型,最后返回了这个临时类型的一个新实例.</p> <p>对传入的对象进行浅拷贝，所以引用类型会保存.只有一个参数时，作用和Object.create()一样。</p> <p>Object.create() 定义第二个参数时和Object.defineProperties第二个参数一样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> anotherP <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token punctuation">{</span>
 name<span class="token operator">:</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span><span class="token string">'lisa'</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
age<span class="token operator">:</span><span class="token punctuation">{</span>
    writable<span class="token operator">:</span><span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;sera&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">color</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;sera&quot;</span><span class="token punctuation">,</span>
  color<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> antherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
antherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Lisa'</span>
antherPerson<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> yetAntherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
yetAntherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'xiaoxing'</span>
yetAntherPerson<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>yetAntherPerson<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//['red','blue','green','yellow']</span>
</code></pre></div><h3 id="（5）-寄生式继承"><a href="#（5）-寄生式继承" class="header-anchor">#</a> （5） 寄生式继承</h3> <p>在原型式继承的基础上直接添加了新的对象方法，除此此外和原型式继承没啥差别，且为对象添加的函数不能复用，和构造函数一样。</p> <blockquote><p>寄生式继承的思路与(寄生)构造函数和工厂模式类似, 即创建一个仅用于封装继承过程的函数,该函数在内部以某种方式来增强对象,最后再像真的是它做了所有工作一样返回对象. 如下.</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createAnother</span><span class="token punctuation">(</span><span class="token parameter">origin</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> origin
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">//增强对象</span>
  o<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token function">createAnother</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
p2<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="（6）寄生组合式继承"><a href="#（6）寄生组合式继承" class="header-anchor">#</a> （6）寄生组合式继承</h3> <p>组合继承最大的问题就是无论什么情况下,都会调用两次父类构造函数: 一次是在创建子类型原型的时候, 另一次是在子类型构造函数内部. <strong>寄生组合式继承就是为了降低调用父类构造函数的开销而出现的</strong> 。</p> <blockquote><p>其背后的基本思路是: 不必为了指定子类型的原型而调用超类型的构造函数</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> SuperType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token comment">// 1.创建一个超类的原型的副本</span>
  <span class="token keyword">var</span> prototype <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
  <span class="token comment">// 2.为该副本添加constructor属性，弥补因重写失去的默认原型</span>
  prototype<span class="token punctuation">.</span>constructor<span class="token operator">=</span>subType
  <span class="token comment">// 3.将创建的副本赋值给子类的原型</span>
  subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Super</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'how are you,'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Super</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">=</span>age
<span class="token punctuation">}</span>
<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>Sub<span class="token punctuation">,</span> Super<span class="token punctuation">)</span>
<span class="token keyword">var</span> p0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token string">'luna'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>
p0<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/myblog/assets/js/app.48f40e30.js" defer></script><script src="/myblog/assets/js/2.667dd462.js" defer></script><script src="/myblog/assets/js/14.b8794301.js" defer></script>
  </body>
</html>
